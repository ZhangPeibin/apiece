{"ast":null,"code":"var _jsxFileName = \"/Users/wiki/code/apiece/src/views/app/App.js\";\nimport './App.css';\nimport * as React from \"react\";\nimport { getLocalUserIdentity } from \"../../common/user\";\nimport PrivateLandingPage from \"./PrivateLandingPage\";\nimport { bucketLinks, getBucketKey } from \"../../common/bucket\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      userIdentity: null,\n      loadingUserIdentity: false\n    };\n  }\n\n  async componentWillMount() {\n    const beginTime = new Date().getTime() / 1000;\n    const localUserIdentity = await getLocalUserIdentity();\n    this.setState({\n      userIdentity: localUserIdentity\n    });\n\n    if (localUserIdentity != null) {\n      const {\n        bucketKey,\n        buckets\n      } = await getBucketKey(localUserIdentity);\n      const links = await bucketLinks(buckets, bucketKey);\n      const query = {\n        bucketKey: bucketKey,\n        buckets: buckets,\n        links: links\n      };\n      this.props.history.push({\n        pathname: \"/dashBoard\",\n        query: query\n      });\n    } else {\n      let loading = document.getElementById('loader');\n\n      if (!loading) {\n        return;\n      }\n\n      loading.style.display = 'inline-block';\n      const endTime = new Date().getTime() / 1000;\n      setTimeout(() => {\n        loading.style.display = 'none';\n        this.setState({\n          loadingUserIdentity: true\n        });\n      }, 1000 - (endTime - beginTime));\n    }\n  }\n\n  render() {\n    if (this.state.loadingUserIdentity) {\n      if (this.state.userIdentity == null) {\n        return /*#__PURE__*/_jsxDEV(PrivateLandingPage, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 24\n        }, this);\n      } else {\n        return /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 21\n        }, this);\n      }\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 17\n      }, this);\n    }\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/wiki/code/apiece/src/views/app/App.js"],"names":["React","getLocalUserIdentity","PrivateLandingPage","bucketLinks","getBucketKey","App","Component","constructor","props","state","userIdentity","loadingUserIdentity","componentWillMount","beginTime","Date","getTime","localUserIdentity","setState","bucketKey","buckets","links","query","history","push","pathname","loading","document","getElementById","style","display","endTime","setTimeout","render"],"mappings":";AAAA,OAAO,WAAP;AACA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,SAAQC,oBAAR,QAAmC,mBAAnC;AACA,OAAOC,kBAAP,MAA+B,sBAA/B;AACA,SAAQC,WAAR,EAAqBC,YAArB,QAAwC,qBAAxC;;;AAEA,MAAMC,GAAN,SAAoBL,KAAK,CAACM,SAA1B,CAAmC;AAC/BC,EAAAA,WAAW,CAACC,KAAD,EAAO;AACd,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACTC,MAAAA,YAAY,EAAG,IADN;AAETC,MAAAA,mBAAmB,EAAG;AAFb,KAAb;AAIH;;AAEuB,QAAlBC,kBAAkB,GAAG;AACvB,UAAMC,SAAS,GAAG,IAAIC,IAAJ,GAAWC,OAAX,KAAqB,IAAvC;AACA,UAAMC,iBAAiB,GAAG,MAAMf,oBAAoB,EAApD;AACA,SAAKgB,QAAL,CAAc;AACNP,MAAAA,YAAY,EAACM;AADP,KAAd;;AAIA,QAAGA,iBAAiB,IAAE,IAAtB,EAA2B;AACvB,YAAM;AAACE,QAAAA,SAAD;AAAYC,QAAAA;AAAZ,UAAuB,MAAMf,YAAY,CAACY,iBAAD,CAA/C;AACA,YAAMI,KAAK,GAAG,MAAMjB,WAAW,CAACgB,OAAD,EAASD,SAAT,CAA/B;AACA,YAAMG,KAAK,GAAG;AACVH,QAAAA,SAAS,EAACA,SADA;AAEVC,QAAAA,OAAO,EAACA,OAFE;AAGVC,QAAAA,KAAK,EAACA;AAHI,OAAd;AAKA,WAAKZ,KAAL,CAAWc,OAAX,CAAmBC,IAAnB,CAAwB;AAACC,QAAAA,QAAQ,EAAE,YAAX;AAAwBH,QAAAA,KAAK,EAAGA;AAAhC,OAAxB;AACH,KATD,MASK;AACD,UAAII,OAAO,GAAGC,QAAQ,CAACC,cAAT,CAAwB,QAAxB,CAAd;;AACA,UAAI,CAACF,OAAL,EAAc;AACV;AACH;;AACDA,MAAAA,OAAO,CAACG,KAAR,CAAcC,OAAd,GAAsB,cAAtB;AAEA,YAAMC,OAAO,GAAG,IAAIhB,IAAJ,GAAWC,OAAX,KAAqB,IAArC;AACAgB,MAAAA,UAAU,CAAC,MAAI;AACXN,QAAAA,OAAO,CAACG,KAAR,CAAcC,OAAd,GAAwB,MAAxB;AACA,aAAKZ,QAAL,CAAc;AACVN,UAAAA,mBAAmB,EAAC;AADV,SAAd;AAGH,OALS,EAKR,QAAQmB,OAAO,GAACjB,SAAhB,CALQ,CAAV;AAMH;AACJ;;AAEDmB,EAAAA,MAAM,GAAG;AACL,QAAI,KAAKvB,KAAL,CAAWE,mBAAf,EAAoC;AAChC,UAAI,KAAKF,KAAL,CAAWC,YAAX,IAA2B,IAA/B,EAAqC;AACjC,4BAAO,QAAC,kBAAD;AAAA;AAAA;AAAA;AAAA,gBAAP;AACH,OAFD,MAEO;AACH,4BACI;AAAA;AAAA;AAAA;AAAA,gBADJ;AAGH;AACJ,KARD,MAQO;AACH,0BACI;AAAA;AAAA;AAAA;AAAA,cADJ;AAGH;AACJ;;AAxD8B;;AA4DnC,eAAeL,GAAf","sourcesContent":["import './App.css';\nimport * as React from \"react\";\nimport {getLocalUserIdentity} from \"../../common/user\";\nimport PrivateLandingPage from \"./PrivateLandingPage\";\nimport {bucketLinks, getBucketKey} from \"../../common/bucket\";\n\nclass App  extends  React.Component{\n    constructor(props){\n        super(props);\n        this.state = {\n            userIdentity : null,\n            loadingUserIdentity : false\n        }\n    }\n\n    async componentWillMount() {\n        const beginTime = new Date().getTime()/1000;\n        const localUserIdentity = await getLocalUserIdentity();\n        this.setState({\n                userIdentity:localUserIdentity\n            }\n        );\n        if(localUserIdentity!=null){\n            const {bucketKey, buckets} = await getBucketKey(localUserIdentity);\n            const links = await bucketLinks(buckets,bucketKey);\n            const query = {\n                bucketKey:bucketKey,\n                buckets:buckets,\n                links:links,\n            };\n            this.props.history.push({pathname: \"/dashBoard\",query : query})\n        }else{\n            let loading = document.getElementById('loader');\n            if (!loading) {\n                return;\n            }\n            loading.style.display='inline-block';\n\n            const endTime = new Date().getTime()/1000;\n            setTimeout(()=>{\n                loading.style.display = 'none';\n                this.setState({\n                    loadingUserIdentity:true\n                })\n            },1000 - (endTime-beginTime));\n        }\n    }\n\n    render() {\n        if (this.state.loadingUserIdentity) {\n            if (this.state.userIdentity == null) {\n                return <PrivateLandingPage/>\n            } else {\n                return (\n                    <div/>\n                );\n            }\n        } else {\n            return (\n                <div/>\n            );\n        }\n    }\n}\n\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}